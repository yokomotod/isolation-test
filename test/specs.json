[
  {
    "name": "dirty write",
    "txs": [
      [
        {
          "query": "BEGIN",
          "want": null,
          "wantOk": null,
          "wantNg": null,
          "wantErr": null
        },
        {
          "query": "UPDATE foo SET value = 20 WHERE id = 1",
          "want": null,
          "wantOk": null,
          "wantNg": null,
          "wantErr": null
        },
        {
          "query": "SELECT value FROM foo WHERE id = 1",
          "want": null,
          "wantOk": [
            {
              "Int64": 20,
              "Valid": true
            }
          ],
          "wantNg": [
            {
              "Int64": 200,
              "Valid": true
            }
          ],
          "wantErr": null
        },
        {
          "query": "ROLLBACK",
          "want": null,
          "wantOk": null,
          "wantNg": null,
          "wantErr": null
        }
      ],
      [
        {
          "query": "BEGIN",
          "want": null,
          "wantOk": null,
          "wantNg": null,
          "wantErr": null
        },
        {
          "query": "UPDATE foo SET value = 200 WHERE id = 1",
          "want": null,
          "wantOk": null,
          "wantNg": null,
          "wantErr": null
        },
        {
          "query": "ROLLBACK",
          "want": null,
          "wantOk": null,
          "wantNg": null,
          "wantErr": null
        }
      ]
    ],
    "threshold": {
      "*": "READ UNCOMMITTED"
    },
    "additionalOk": null,
    "wantStarts": {
      "*": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "a:3",
        "b:2"
      ],
      "NO TRANSACTION": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "b:2",
        "a:3"
      ]
    },
    "wantEnds": {
      "*": [
        "a:0",
        "b:0",
        "a:1",
        "a:2",
        "a:3",
        "b:1",
        "b:2"
      ],
      "NO TRANSACTION": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "b:2",
        "a:3"
      ]
    },
    "skip": null
  },
  {
    "name": "dirty read",
    "txs": [
      [
        {
          "query": "BEGIN",
          "want": null,
          "wantOk": null,
          "wantNg": null,
          "wantErr": null
        },
        {
          "query": "UPDATE foo SET value = 20 WHERE id = 1",
          "want": null,
          "wantOk": null,
          "wantNg": null,
          "wantErr": null
        },
        {
          "query": "ROLLBACK",
          "want": null,
          "wantOk": null,
          "wantNg": null,
          "wantErr": null
        }
      ],
      [
        {
          "query": "BEGIN",
          "want": null,
          "wantOk": null,
          "wantNg": null,
          "wantErr": null
        },
        {
          "query": "SELECT value FROM foo WHERE id = 1",
          "want": null,
          "wantOk": [
            {
              "Int64": 2,
              "Valid": true
            }
          ],
          "wantNg": [
            {
              "Int64": 20,
              "Valid": true
            }
          ],
          "wantErr": null
        },
        {
          "query": "ROLLBACK",
          "want": null,
          "wantOk": null,
          "wantNg": null,
          "wantErr": null
        }
      ]
    ],
    "threshold": {
      "*": "READ COMMITTED",
      "postgres": "READ UNCOMMITTED"
    },
    "additionalOk": null,
    "wantStarts": {
      "*": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "b:2"
      ]
    },
    "wantEnds": {
      "*": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "b:2"
      ],
      "NO TRANSACTION": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "b:2"
      ],
      "db2:CURSOR STABILITY": [
        "a:0",
        "b:0",
        "a:1",
        "a:2",
        "b:1",
        "b:2"
      ],
      "db2:REPEATABLE READ": [
        "a:0",
        "b:0",
        "a:1",
        "a:2",
        "b:1",
        "b:2"
      ],
      "db2:RS": [
        "a:0",
        "b:0",
        "a:1",
        "a:2",
        "b:1",
        "b:2"
      ],
      "db2:SERIALIZABLE": [
        "a:0",
        "b:0",
        "a:1",
        "a:2",
        "b:1",
        "b:2"
      ],
      "mysql:SERIALIZABLE": [
        "a:0",
        "b:0",
        "a:1",
        "a:2",
        "b:1",
        "b:2"
      ],
      "sqlserver:READ COMMITTED": [
        "a:0",
        "b:0",
        "a:1",
        "a:2",
        "b:1",
        "b:2"
      ],
      "sqlserver:REPEATABLE READ": [
        "a:0",
        "b:0",
        "a:1",
        "a:2",
        "b:1",
        "b:2"
      ],
      "sqlserver:SERIALIZABLE": [
        "a:0",
        "b:0",
        "a:1",
        "a:2",
        "b:1",
        "b:2"
      ]
    },
    "skip": null
  },
  {
    "name": "fuzzy read",
    "txs": [
      [
        {
          "query": "",
          "want": null,
          "wantOk": null,
          "wantNg": null,
          "wantErr": null
        },
        {
          "query": "",
          "want": null,
          "wantOk": null,
          "wantNg": null,
          "wantErr": null
        },
        {
          "query": "UPDATE foo SET value = 20 WHERE id = 1",
          "want": null,
          "wantOk": null,
          "wantNg": null,
          "wantErr": null
        }
      ],
      [
        {
          "query": "BEGIN",
          "want": null,
          "wantOk": null,
          "wantNg": null,
          "wantErr": null
        },
        {
          "query": "SELECT value FROM foo WHERE id = 1",
          "want": [
            {
              "Int64": 2,
              "Valid": true
            }
          ],
          "wantOk": null,
          "wantNg": null,
          "wantErr": null
        },
        {
          "query": "SELECT value FROM foo WHERE id = 1",
          "want": null,
          "wantOk": [
            {
              "Int64": 2,
              "Valid": true
            }
          ],
          "wantNg": [
            {
              "Int64": 20,
              "Valid": true
            }
          ],
          "wantErr": null
        },
        {
          "query": "ROLLBACK",
          "want": null,
          "wantOk": null,
          "wantNg": null,
          "wantErr": null
        }
      ]
    ],
    "threshold": {
      "*": "REPEATABLE READ",
      "db2": "RS"
    },
    "additionalOk": null,
    "wantStarts": {
      "*": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "b:2",
        "b:3"
      ]
    },
    "wantEnds": {
      "*": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "b:2",
        "b:3"
      ],
      "db2:REPEATABLE READ": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "b:2",
        "b:3",
        "a:2"
      ],
      "db2:RS": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "b:2",
        "b:3",
        "a:2"
      ],
      "db2:SERIALIZABLE": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "b:2",
        "b:3",
        "a:2"
      ],
      "mysql:SERIALIZABLE": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "b:2",
        "b:3",
        "a:2"
      ],
      "sqlite:SERIALIZABLE": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "b:2",
        "b:3",
        "a:2"
      ],
      "sqlserver:REPEATABLE READ": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "b:2",
        "b:3",
        "a:2"
      ],
      "sqlserver:SERIALIZABLE": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "b:2",
        "b:3",
        "a:2"
      ]
    },
    "skip": null
  },
  {
    "name": "fuzzy read with locking read",
    "txs": [
      [
        {
          "query": "",
          "want": null,
          "wantOk": null,
          "wantNg": null,
          "wantErr": null
        },
        {
          "query": "",
          "want": null,
          "wantOk": null,
          "wantNg": null,
          "wantErr": null
        },
        {
          "query": "UPDATE foo SET value = 20 WHERE id = 1",
          "want": null,
          "wantOk": null,
          "wantNg": null,
          "wantErr": null
        }
      ],
      [
        {
          "query": "BEGIN",
          "want": null,
          "wantOk": null,
          "wantNg": null,
          "wantErr": null
        },
        {
          "query": "SELECT value FROM foo WHERE id = 1",
          "want": [
            {
              "Int64": 2,
              "Valid": true
            }
          ],
          "wantOk": null,
          "wantNg": null,
          "wantErr": null
        },
        {
          "query": "SELECT value FROM foo WHERE id = 1 FOR SHARE",
          "want": null,
          "wantOk": [
            {
              "Int64": 2,
              "Valid": true
            }
          ],
          "wantNg": [
            {
              "Int64": 20,
              "Valid": true
            }
          ],
          "wantErr": {
            "postgres:REPEATABLE READ": "ERROR: could not serialize access due to concurrent update (SQLSTATE 40001)",
            "postgres:SERIALIZABLE": "ERROR: could not serialize access due to concurrent update (SQLSTATE 40001)"
          }
        },
        {
          "query": "ROLLBACK",
          "want": null,
          "wantOk": null,
          "wantNg": null,
          "wantErr": null
        }
      ]
    ],
    "threshold": {
      "*": "REPEATABLE READ",
      "mysql": "SERIALIZABLE"
    },
    "additionalOk": null,
    "wantStarts": {
      "*": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "b:2",
        "b:3"
      ],
      "postgres:REPEATABLE READ": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "b:2"
      ],
      "postgres:SERIALIZABLE": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "b:2"
      ]
    },
    "wantEnds": {
      "*": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "b:2",
        "b:3"
      ],
      "mysql:SERIALIZABLE": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "b:2",
        "b:3",
        "a:2"
      ],
      "postgres:REPEATABLE READ": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "b:2"
      ],
      "postgres:SERIALIZABLE": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "b:2"
      ]
    },
    "skip": {
      "db2": true,
      "oracle": true,
      "sqlite": true,
      "sqlserver": true
    }
  },
  {
    "name": "phantom read",
    "txs": [
      [
        {
          "query": "SELECT count(*) FROM foo",
          "want": [
            {
              "Int64": 2,
              "Valid": true
            }
          ],
          "wantOk": null,
          "wantNg": null,
          "wantErr": null
        },
        {
          "query": "",
          "want": null,
          "wantOk": null,
          "wantNg": null,
          "wantErr": null
        },
        {
          "query": "INSERT INTO foo VALUES (2, 20)",
          "want": null,
          "wantOk": null,
          "wantNg": null,
          "wantErr": null
        }
      ],
      [
        {
          "query": "BEGIN",
          "want": null,
          "wantOk": null,
          "wantNg": null,
          "wantErr": null
        },
        {
          "query": "SELECT count(*) FROM foo WHERE id \u003c 3",
          "want": [
            {
              "Int64": 1,
              "Valid": true
            }
          ],
          "wantOk": null,
          "wantNg": null,
          "wantErr": null
        },
        {
          "query": "SELECT count(*) FROM foo WHERE id \u003c 3",
          "want": null,
          "wantOk": [
            {
              "Int64": 1,
              "Valid": true
            }
          ],
          "wantNg": [
            {
              "Int64": 2,
              "Valid": true
            }
          ],
          "wantErr": null
        },
        {
          "query": "ROLLBACK",
          "want": null,
          "wantOk": null,
          "wantNg": null,
          "wantErr": null
        }
      ]
    ],
    "threshold": {
      "*": "REPEATABLE READ",
      "sqlserver": "SERIALIZABLE"
    },
    "additionalOk": {
      "sqlserver": [
        "SNAPSHOT"
      ]
    },
    "wantStarts": {
      "*": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "b:2",
        "b:3"
      ]
    },
    "wantEnds": {
      "*": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "b:2",
        "b:3"
      ],
      "db2:REPEATABLE READ": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "b:2",
        "b:3",
        "a:2"
      ],
      "db2:SERIALIZABLE": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "b:2",
        "b:3",
        "a:2"
      ],
      "mysql:SERIALIZABLE": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "b:2",
        "b:3",
        "a:2"
      ],
      "sqlite:SERIALIZABLE": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "b:2",
        "b:3",
        "a:2"
      ],
      "sqlserver:SERIALIZABLE": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "b:2",
        "b:3",
        "a:2"
      ]
    },
    "skip": null
  },
  {
    "name": "phantom read with locking read",
    "txs": [
      [
        {
          "query": "",
          "want": null,
          "wantOk": null,
          "wantNg": null,
          "wantErr": null
        },
        {
          "query": "",
          "want": null,
          "wantOk": null,
          "wantNg": null,
          "wantErr": null
        },
        {
          "query": "INSERT INTO foo VALUES (2, 20)",
          "want": null,
          "wantOk": null,
          "wantNg": null,
          "wantErr": null
        }
      ],
      [
        {
          "query": "BEGIN",
          "want": null,
          "wantOk": null,
          "wantNg": null,
          "wantErr": null
        },
        {
          "query": "SELECT count(*) FROM foo WHERE id \u003c 3",
          "want": [
            {
              "Int64": 1,
              "Valid": true
            }
          ],
          "wantOk": null,
          "wantNg": null,
          "wantErr": null
        },
        {
          "query": "SELECT id FROM foo WHERE id \u003c 3 FOR SHARE",
          "want": null,
          "wantOk": [
            {
              "Int64": 1,
              "Valid": true
            }
          ],
          "wantNg": [
            {
              "Int64": 1,
              "Valid": true
            },
            {
              "Int64": 2,
              "Valid": true
            }
          ],
          "wantErr": null
        },
        {
          "query": "ROLLBACK",
          "want": null,
          "wantOk": null,
          "wantNg": null,
          "wantErr": null
        }
      ]
    ],
    "threshold": {
      "*": "REPEATABLE READ",
      "mysql": "SERIALIZABLE"
    },
    "additionalOk": null,
    "wantStarts": {
      "*": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "b:2",
        "b:3"
      ]
    },
    "wantEnds": {
      "*": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "b:2",
        "b:3"
      ],
      "mysql:SERIALIZABLE": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "b:2",
        "b:3",
        "a:2"
      ]
    },
    "skip": {
      "db2": true,
      "oracle": true,
      "sqlite": true,
      "sqlserver": true
    }
  },
  {
    "name": "lost update",
    "txs": [
      [
        {
          "query": "BEGIN",
          "want": null,
          "wantOk": null,
          "wantNg": null,
          "wantErr": null
        },
        {
          "query": "SELECT value FROM foo WHERE id = 1",
          "want": [
            {
              "Int64": 2,
              "Valid": true
            }
          ],
          "wantOk": null,
          "wantNg": null,
          "wantErr": null
        },
        {
          "query": "UPDATE foo SET value = 20 WHERE id = 1",
          "want": null,
          "wantOk": null,
          "wantNg": null,
          "wantErr": null
        },
        {
          "query": "COMMIT",
          "want": null,
          "wantOk": null,
          "wantNg": null,
          "wantErr": null
        },
        {
          "query": "SELECT value FROM foo WHERE id = 1",
          "want": null,
          "wantOk": [
            {
              "Int64": 20,
              "Valid": true
            }
          ],
          "wantNg": [
            {
              "Int64": 200,
              "Valid": true
            }
          ],
          "wantErr": null
        }
      ],
      [
        {
          "query": "BEGIN",
          "want": null,
          "wantOk": null,
          "wantNg": null,
          "wantErr": null
        },
        {
          "query": "SELECT value FROM foo WHERE id = 1",
          "want": [
            {
              "Int64": 2,
              "Valid": true
            }
          ],
          "wantOk": null,
          "wantNg": null,
          "wantErr": null
        },
        {
          "query": "UPDATE foo SET value = 200 WHERE id = 1",
          "want": null,
          "wantOk": null,
          "wantNg": null,
          "wantErr": {
            "db2:REPEATABLE READ": "SQLExecute: {40001} [IBM][CLI Driver][DB2/LINUXX8664] SQL0911N  The current transaction has been rolled back because of a deadlock or timeout.  Reason code \"2\".  SQLSTATE=40001\n",
            "db2:RS": "SQLExecute: {40001} [IBM][CLI Driver][DB2/LINUXX8664] SQL0911N  The current transaction has been rolled back because of a deadlock or timeout.  Reason code \"2\".  SQLSTATE=40001\n",
            "db2:SERIALIZABLE": "SQLExecute: {40001} [IBM][CLI Driver][DB2/LINUXX8664] SQL0911N  The current transaction has been rolled back because of a deadlock or timeout.  Reason code \"2\".  SQLSTATE=40001\n",
            "mysql:SERIALIZABLE": "Error 1213: Deadlock found when trying to get lock; try restarting transaction",
            "oracle:SERIALIZABLE": "ORA-08177: can't serialize access for this transaction\n",
            "postgres:REPEATABLE READ": "ERROR: could not serialize access due to concurrent update (SQLSTATE 40001)",
            "postgres:SERIALIZABLE": "ERROR: could not serialize access due to concurrent update (SQLSTATE 40001)",
            "sqlserver:REPEATABLE READ": "mssql: Transaction \\(Process ID \\d+\\) was deadlocked on lock resources with another process and has been chosen as the deadlock victim. Rerun the transaction\\.",
            "sqlserver:SERIALIZABLE": "mssql: Transaction \\(Process ID \\d+\\) was deadlocked on lock resources with another process and has been chosen as the deadlock victim. Rerun the transaction\\.",
            "sqlserver:SNAPSHOT": "mssql: Snapshot isolation transaction aborted due to update conflict. You cannot use snapshot isolation to access table 'dbo.foo' directly or indirectly in database 'test2' to update, delete, or insert the row that has been modified or deleted by another transaction. Retry the transaction or change the isolation level for the update/delete statement."
          }
        },
        {
          "query": "COMMIT",
          "want": null,
          "wantOk": null,
          "wantNg": null,
          "wantErr": null
        },
        {
          "query": "SELECT value FROM foo WHERE id = 1",
          "want": [
            {
              "Int64": 200,
              "Valid": true
            }
          ],
          "wantOk": null,
          "wantNg": null,
          "wantErr": null
        }
      ]
    ],
    "threshold": {
      "*": "SERIALIZABLE",
      "db2": "RS",
      "postgres": "REPEATABLE READ",
      "sqlserver": "REPEATABLE READ"
    },
    "additionalOk": null,
    "wantStarts": {
      "*": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "b:2",
        "a:3",
        "b:3",
        "a:4",
        "b:4"
      ],
      "SERIALIZABLE": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "b:2",
        "a:3",
        "a:4"
      ],
      "db2:REPEATABLE READ": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "b:2",
        "a:3",
        "a:4"
      ],
      "db2:RS": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "b:2",
        "a:3",
        "a:4"
      ],
      "db2:SERIALIZABLE": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "b:2",
        "a:3",
        "a:4"
      ],
      "postgres:REPEATABLE READ": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "b:2",
        "a:3",
        "a:4"
      ],
      "sqlserver:REPEATABLE READ": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "b:2",
        "a:3",
        "a:4"
      ],
      "sqlserver:SNAPSHOT": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "b:2",
        "a:3",
        "a:4"
      ]
    },
    "wantEnds": {
      "*": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "a:3",
        "b:2",
        "a:4",
        "b:3",
        "b:4"
      ],
      "NO TRANSACTION": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "b:2",
        "a:3",
        "b:3",
        "a:4",
        "b:4"
      ],
      "SERIALIZABLE": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "b:2",
        "a:2",
        "a:3",
        "a:4"
      ],
      "db2:REPEATABLE READ": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "b:2",
        "a:2",
        "a:3",
        "a:4"
      ],
      "db2:RS": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "b:2",
        "a:2",
        "a:3",
        "a:4"
      ],
      "db2:SERIALIZABLE": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "b:2",
        "a:2",
        "a:3",
        "a:4"
      ],
      "oracle:SERIALIZABLE": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "a:3",
        "b:2",
        "a:4"
      ],
      "postgres:REPEATABLE READ": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "a:3",
        "b:2",
        "a:4"
      ],
      "postgres:SERIALIZABLE": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "a:3",
        "b:2",
        "a:4"
      ],
      "sqlserver:REPEATABLE READ": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "b:2",
        "a:3",
        "a:4"
      ],
      "sqlserver:SNAPSHOT": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "a:3",
        "b:2",
        "a:4"
      ]
    },
    "skip": {
      "sqlite:SERIALIZABLE": true
    }
  },
  {
    "name": "lost update with locking read",
    "txs": [
      [
        {
          "query": "BEGIN",
          "want": null,
          "wantOk": null,
          "wantNg": null,
          "wantErr": null
        },
        {
          "query": "SELECT value FROM foo WHERE id = 1 FOR UPDATE",
          "want": [
            {
              "Int64": 2,
              "Valid": true
            }
          ],
          "wantOk": null,
          "wantNg": null,
          "wantErr": null
        },
        {
          "query": "UPDATE foo SET value = 20 WHERE id = 1",
          "want": null,
          "wantOk": null,
          "wantNg": null,
          "wantErr": null
        },
        {
          "query": "COMMIT",
          "want": null,
          "wantOk": null,
          "wantNg": null,
          "wantErr": null
        },
        {
          "query": "SELECT value FROM foo WHERE id = 1",
          "want": [
            {
              "Int64": 20,
              "Valid": true
            }
          ],
          "wantOk": null,
          "wantNg": null,
          "wantErr": null
        }
      ],
      [
        {
          "query": "BEGIN",
          "want": null,
          "wantOk": null,
          "wantNg": null,
          "wantErr": null
        },
        {
          "query": "SELECT value FROM foo WHERE id = 1 FOR UPDATE",
          "want": [
            {
              "Int64": 20,
              "Valid": true
            }
          ],
          "wantOk": null,
          "wantNg": null,
          "wantErr": {
            "oracle:SERIALIZABLE": "ORA-08177: can't serialize access for this transaction\n",
            "postgres:REPEATABLE READ": "ERROR: could not serialize access due to concurrent update (SQLSTATE 40001)",
            "postgres:SERIALIZABLE": "ERROR: could not serialize access due to concurrent update (SQLSTATE 40001)"
          }
        },
        {
          "query": "UPDATE foo SET value = 200 WHERE id = 1",
          "want": null,
          "wantOk": null,
          "wantNg": null,
          "wantErr": null
        },
        {
          "query": "COMMIT",
          "want": null,
          "wantOk": null,
          "wantNg": null,
          "wantErr": null
        },
        {
          "query": "SELECT value FROM foo WHERE id = 1",
          "want": [
            {
              "Int64": 200,
              "Valid": true
            }
          ],
          "wantOk": null,
          "wantNg": null,
          "wantErr": null
        }
      ]
    ],
    "threshold": {
      "*": "READ UNCOMMITTED"
    },
    "additionalOk": null,
    "wantStarts": {
      "*": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "a:3",
        "b:2",
        "a:4",
        "b:3",
        "b:4",
        "b:5"
      ],
      "oracle:SERIALIZABLE": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "a:3",
        "a:4"
      ],
      "postgres:REPEATABLE READ": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "a:3",
        "a:4"
      ],
      "postgres:SERIALIZABLE": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "a:3",
        "a:4"
      ]
    },
    "wantEnds": {
      "*": [
        "a:0",
        "b:0",
        "a:1",
        "a:2",
        "a:3",
        "b:1",
        "a:4",
        "b:2",
        "b:3",
        "b:4",
        "b:5"
      ],
      "oracle:SERIALIZABLE": [
        "a:0",
        "b:0",
        "a:1",
        "a:2",
        "a:3",
        "b:1",
        "a:4"
      ],
      "postgres:REPEATABLE READ": [
        "a:0",
        "b:0",
        "a:1",
        "a:2",
        "a:3",
        "b:1",
        "a:4"
      ],
      "postgres:SERIALIZABLE": [
        "a:0",
        "b:0",
        "a:1",
        "a:2",
        "a:3",
        "b:1",
        "a:4"
      ]
    },
    "skip": {
      "db2": true,
      "mysql:NO TRANSACTION": true,
      "oracle:NO TRANSACTION": true,
      "postgres:NO TRANSACTION": true,
      "sqlite": true,
      "sqlserver:NO TRANSACTION": true,
      "sqlserver:SNAPSHOT": true
    }
  },
  {
    "name": "G-cursor",
    "txs": [
      [
        {
          "query": "BEGIN",
          "want": null,
          "wantOk": null,
          "wantNg": null,
          "wantErr": null
        },
        {
          "query": "SELECT value FROM foo WHERE id = 1",
          "want": [
            {
              "Int64": 2,
              "Valid": true
            }
          ],
          "wantOk": null,
          "wantNg": null,
          "wantErr": null
        },
        {
          "query": "UPDATE foo SET value = 12 WHERE id = 1",
          "want": null,
          "wantOk": null,
          "wantNg": null,
          "wantErr": null
        },
        {
          "query": "COMMIT",
          "want": null,
          "wantOk": null,
          "wantNg": null,
          "wantErr": null
        }
      ],
      [
        {
          "query": "BEGIN",
          "want": null,
          "wantOk": null,
          "wantNg": null,
          "wantErr": null
        },
        {
          "query": "",
          "want": null,
          "wantOk": null,
          "wantNg": null,
          "wantErr": null
        },
        {
          "query": "SELECT value FROM foo WHERE id = 1",
          "want": null,
          "wantOk": [
            {
              "Int64": 12,
              "Valid": true
            }
          ],
          "wantNg": [
            {
              "Int64": 2,
              "Valid": true
            }
          ],
          "wantErr": null
        },
        {
          "query": "UPDATE foo SET value = 112 WHERE id = 1",
          "want": null,
          "wantOk": null,
          "wantNg": null,
          "wantErr": {
            "oracle:SERIALIZABLE": "ORA-08177: can't serialize access for this transaction\n",
            "postgres:REPEATABLE READ": "ERROR: could not serialize access due to concurrent update (SQLSTATE 40001)",
            "postgres:SERIALIZABLE": "ERROR: could not serialize access due to concurrent update (SQLSTATE 40001)",
            "sqlserver:SNAPSHOT": "mssql: Snapshot isolation transaction aborted due to update conflict. You cannot use snapshot isolation to access table 'dbo.foo' directly or indirectly in database 'test2' to update, delete, or insert the row that has been modified or deleted by another transaction. Retry the transaction or change the isolation level for the update/delete statement."
          }
        },
        {
          "query": "COMMIT",
          "want": null,
          "wantOk": null,
          "wantNg": null,
          "wantErr": null
        },
        {
          "query": "SELECT value FROM foo WHERE id = 1",
          "want": [
            {
              "Int64": 112,
              "Valid": true
            }
          ],
          "wantOk": null,
          "wantNg": null,
          "wantErr": null
        }
      ]
    ],
    "threshold": {
      "*": "SERIALIZABLE",
      "db2": "CURSOR STABILITY",
      "postgres": "REPEATABLE READ"
    },
    "additionalOk": {
      "sqlserver": [
        "READ COMMITTED",
        "REPEATABLE READ"
      ]
    },
    "wantStarts": {
      "*": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "b:2",
        "a:3",
        "b:3",
        "b:4",
        "b:5"
      ],
      "oracle:SERIALIZABLE": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "b:2",
        "a:3",
        "b:3"
      ],
      "postgres:REPEATABLE READ": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "b:2",
        "a:3",
        "b:3"
      ],
      "postgres:SERIALIZABLE": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "b:2",
        "a:3",
        "b:3"
      ],
      "sqlserver:SNAPSHOT": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "b:2",
        "a:3",
        "b:3"
      ]
    },
    "wantEnds": {
      "*": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "b:2",
        "a:3",
        "b:3",
        "b:4",
        "b:5"
      ],
      "db2:CURSOR STABILITY": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "a:3",
        "b:2",
        "b:3",
        "b:4",
        "b:5"
      ],
      "db2:REPEATABLE READ": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "a:3",
        "b:2",
        "b:3",
        "b:4",
        "b:5"
      ],
      "db2:RS": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "a:3",
        "b:2",
        "b:3",
        "b:4",
        "b:5"
      ],
      "db2:SERIALIZABLE": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "a:3",
        "b:2",
        "b:3",
        "b:4",
        "b:5"
      ],
      "mysql:SERIALIZABLE": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "a:3",
        "b:2",
        "b:3",
        "b:4",
        "b:5"
      ],
      "oracle:SERIALIZABLE": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "b:2",
        "a:3",
        "b:3"
      ],
      "postgres:REPEATABLE READ": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "b:2",
        "a:3",
        "b:3"
      ],
      "postgres:SERIALIZABLE": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "b:2",
        "a:3",
        "b:3"
      ],
      "sqlserver:READ COMMITTED": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "a:3",
        "b:2",
        "b:3",
        "b:4",
        "b:5"
      ],
      "sqlserver:REPEATABLE READ": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "a:3",
        "b:2",
        "b:3",
        "b:4",
        "b:5"
      ],
      "sqlserver:SERIALIZABLE": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "a:3",
        "b:2",
        "b:3",
        "b:4",
        "b:5"
      ],
      "sqlserver:SNAPSHOT": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "b:2",
        "a:3",
        "b:3"
      ]
    },
    "skip": {
      "db2:NO TRANSACTION": true,
      "db2:READ UNCOMMITTED": true,
      "mysql:NO TRANSACTION": true,
      "mysql:READ UNCOMMITTED": true,
      "oracle:NO TRANSACTION": true,
      "oracle:READ UNCOMMITTED": true,
      "oracle:SERIALIZABLE": true,
      "postgres:NO TRANSACTION": true,
      "postgres:READ UNCOMMITTED": true,
      "postgres:REPEATABLE READ": true,
      "postgres:SERIALIZABLE": true,
      "sqlite": true,
      "sqlserver:NO TRANSACTION": true,
      "sqlserver:READ UNCOMMITTED": true
    }
  },
  {
    "name": "write skew",
    "txs": [
      [
        {
          "query": "BEGIN",
          "want": null,
          "wantOk": null,
          "wantNg": null,
          "wantErr": null
        },
        {
          "query": "SELECT value FROM foo WHERE id = 1",
          "want": [
            {
              "Int64": 2,
              "Valid": true
            }
          ],
          "wantOk": null,
          "wantNg": null,
          "wantErr": null
        },
        {
          "query": "UPDATE foo SET value = 20 WHERE id = 3",
          "want": null,
          "wantOk": null,
          "wantNg": null,
          "wantErr": {
            "db2:REPEATABLE READ": "SQLExecute: {40001} [IBM][CLI Driver][DB2/LINUXX8664] SQL0911N  The current transaction has been rolled back because of a deadlock or timeout.  Reason code \"2\".  SQLSTATE=40001\n",
            "db2:RS": "SQLExecute: {40001} [IBM][CLI Driver][DB2/LINUXX8664] SQL0911N  The current transaction has been rolled back because of a deadlock or timeout.  Reason code \"2\".  SQLSTATE=40001\n",
            "db2:SERIALIZABLE": "SQLExecute: {40001} [IBM][CLI Driver][DB2/LINUXX8664] SQL0911N  The current transaction has been rolled back because of a deadlock or timeout.  Reason code \"2\".  SQLSTATE=40001\n"
          }
        },
        {
          "query": "SELECT value FROM foo WHERE id = 3",
          "want": [
            {
              "Int64": 20,
              "Valid": true
            }
          ],
          "wantOk": null,
          "wantNg": null,
          "wantErr": null
        },
        {
          "query": "COMMIT",
          "want": null,
          "wantOk": null,
          "wantNg": null,
          "wantErr": null
        },
        {
          "query": "SELECT value FROM foo WHERE id = 1",
          "want": null,
          "wantOk": [
            {
              "Int64": 2,
              "Valid": true
            }
          ],
          "wantNg": [
            {
              "Int64": 40,
              "Valid": true
            }
          ],
          "wantErr": null
        }
      ],
      [
        {
          "query": "BEGIN",
          "want": null,
          "wantOk": null,
          "wantNg": null,
          "wantErr": null
        },
        {
          "query": "SELECT value FROM foo WHERE id = 3",
          "want": [
            {
              "Int64": 4,
              "Valid": true
            }
          ],
          "wantOk": null,
          "wantNg": null,
          "wantErr": null
        },
        {
          "query": "UPDATE foo SET value = 40 WHERE id = 1",
          "want": null,
          "wantOk": null,
          "wantNg": null,
          "wantErr": {
            "mysql:SERIALIZABLE": "Error 1213: Deadlock found when trying to get lock; try restarting transaction",
            "sqlserver:REPEATABLE READ": "mssql: Transaction \\(Process ID \\d+\\) was deadlocked on lock resources with another process and has been chosen as the deadlock victim. Rerun the transaction\\.",
            "sqlserver:SERIALIZABLE": "mssql: Transaction \\(Process ID \\d+\\) was deadlocked on lock resources with another process and has been chosen as the deadlock victim. Rerun the transaction\\."
          }
        },
        {
          "query": "SELECT value FROM foo WHERE id = 1",
          "want": null,
          "wantOk": null,
          "wantNg": [
            {
              "Int64": 40,
              "Valid": true
            }
          ],
          "wantErr": null
        },
        {
          "query": "COMMIT",
          "want": null,
          "wantOk": null,
          "wantNg": null,
          "wantErr": {
            "postgres:SERIALIZABLE": "ERROR: could not serialize access due to read/write dependencies among transactions (SQLSTATE 40001)"
          }
        },
        {
          "query": "SELECT value FROM foo WHERE id = 3",
          "want": null,
          "wantOk": [
            {
              "Int64": 4,
              "Valid": true
            }
          ],
          "wantNg": [
            {
              "Int64": 20,
              "Valid": true
            }
          ],
          "wantErr": null
        }
      ]
    ],
    "threshold": {
      "*": "SERIALIZABLE",
      "db2": "RS",
      "oracle": "NEVER"
    },
    "additionalOk": {
      "sqlserver": [
        "REPEATABLE READ"
      ]
    },
    "wantStarts": {
      "*": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "b:2",
        "a:3",
        "b:3",
        "a:4",
        "b:4",
        "a:5",
        "b:5"
      ],
      "db2:REPEATABLE READ": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "b:2",
        "b:3",
        "b:4",
        "b:5"
      ],
      "db2:RS": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "b:2",
        "b:3",
        "b:4",
        "b:5"
      ],
      "db2:SERIALIZABLE": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "b:2",
        "b:3",
        "b:4",
        "b:5"
      ],
      "mysql:SERIALIZABLE": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "b:2",
        "a:3",
        "a:4",
        "a:5"
      ],
      "postgres:SERIALIZABLE": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "b:2",
        "a:3",
        "b:3",
        "a:4",
        "b:4",
        "a:5"
      ],
      "sqlserver:REPEATABLE READ": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "b:2",
        "a:3",
        "a:4",
        "a:5"
      ],
      "sqlserver:SERIALIZABLE": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "b:2",
        "a:3",
        "a:4",
        "a:5"
      ]
    },
    "wantEnds": {
      "*": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "b:2",
        "a:3",
        "b:3",
        "a:4",
        "b:4",
        "a:5",
        "b:5"
      ],
      "db2:REPEATABLE READ": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "b:2",
        "b:3",
        "b:4",
        "b:5"
      ],
      "db2:RS": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "b:2",
        "b:3",
        "b:4",
        "b:5"
      ],
      "db2:SERIALIZABLE": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "b:2",
        "b:3",
        "b:4",
        "b:5"
      ],
      "mysql:SERIALIZABLE": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "b:2",
        "a:2",
        "a:3",
        "a:4",
        "a:5"
      ],
      "postgres:SERIALIZABLE": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "b:2",
        "a:3",
        "b:3",
        "a:4",
        "b:4",
        "a:5"
      ],
      "sqlserver:REPEATABLE READ": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "b:2",
        "a:3",
        "a:4",
        "a:5"
      ],
      "sqlserver:SERIALIZABLE": [
        "a:0",
        "b:0",
        "a:1",
        "b:1",
        "a:2",
        "b:2",
        "a:3",
        "a:4",
        "a:5"
      ]
    },
    "skip": {
      "sqlite:SERIALIZABLE": true
    }
  }
]